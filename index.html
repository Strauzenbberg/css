<!doctype html>
<html lang="pt-br">
<head>
<meta charset="utf-8">
<title>Code View</title>
<style>
  body,html {margin:0;height:100%;display:flex;flex-direction:column;font-family:sans-serif;background:#1e1e2f;color:#eee;}
  header {background:#2a2a3d;padding:10px;display:flex;gap:10px;align-items:center;border-bottom:1px solid #444;}
  button {
    padding:8px 14px;
    border:0;
    border-radius:6px;
    cursor:pointer;
    font-weight:600;
    background:#3a3a4f;
    color:#eee;
    transition:background .2s;
  }
  button:hover {background:#505065;}
  .top {display:flex;flex:1;min-height:100px;}
  textarea {
    flex:1;
    padding:10px;
    font-family:monospace;
    font-size:14px;
    resize:none;
    border:1px solid #444;
    background:#1e1e2f;
    color:#eee;
  }
  .gutter {
    height:6px;
    background:#333;
    cursor:row-resize;
  }
  .bottom {flex:1;}
  iframe {width:100%;height:100%;border:0;background:#fff;}
</style>
</head>
<body>
  <header>
    <button id="paste">Paste</button>
    <button id="clear">Clear</button>
    <button id="copy">Copy</button>
    <button id="download">Download</button>
  </header>
  <div class="top" id="top">
    <textarea id="html" placeholder="HTML"></textarea>
    <textarea id="css" placeholder="CSS"></textarea>
    <textarea id="js" placeholder="JS"></textarea>
  </div>
  <div class="gutter" id="gutter"></div>
  <div class="bottom"><iframe id="preview"></iframe></div>

<script>
const html = document.getElementById('html');
const css = document.getElementById('css');
const js = document.getElementById('js');
const iframe = document.getElementById('preview');

function render(){
  const code = `
<!doctype html>
<html><head><style>${css.value}</style></head>
<body>
${html.value}
<script>${js.value}<\/script>
</body></html>`;
  iframe.srcdoc = code;
}

// auto-execução
[html, css, js].forEach(ed => ed.addEventListener('input', render));

// Botões
document.getElementById('clear').onclick = () => {
  html.value = css.value = js.value = '';
  render();
};
document.getElementById('copy').onclick = async () => {
  try {
    await navigator.clipboard.writeText(iframe.srcdoc);
    alert('Code copied!');
  } catch { alert('Copy failed'); }
};
document.getElementById('paste').onclick = async () => {
  try {
    const text = await navigator.clipboard.readText();
    html.value = text;
    render();
  } catch { alert('Paste failed'); }
};
document.getElementById('download').onclick = () => {
  const blob = new Blob([iframe.srcdoc], {type:'text/html'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'project.html';
  a.click();
  URL.revokeObjectURL(a.href);
};

// Divisor arrastável corrigido
const gutter = document.getElementById('gutter');
let dragging=false,startY,startH;
gutter.addEventListener('mousedown',e=>{
  dragging=true;startY=e.clientY;startH=document.getElementById('top').offsetHeight;
});
window.addEventListener('mousemove',e=>{
  if(!dragging)return;
  const dy=e.clientY-startY;
  const newH=startH+dy;
  if(newH>80 && newH<window.innerHeight-100){
    document.getElementById('top').style.height=newH+'px';
  }
});
window.addEventListener('mouseup',()=>dragging=false);

// Render inicial
render();
</script>
</body>
</html>
